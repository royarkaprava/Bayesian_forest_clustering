---
title: "Reproducibility report"
output: html_document
date: "2023-07-17"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=F}
setwd("~/git/Bayesian_forest_clustering")
```

## Figure 1 is an illustrative plot that can be generated using "clusterSim" R package, and does not require fitting of the Bayesian spanning forest model.

```{r}
packageVersion("Igraph") 
packageVersion("GIGrvg")
packageVersion("gtools")
packageVersion("kernlab")
packageVersion("RcppML")
packageVersion("mclust")
packageVersion("clusterSim")
```

```{r, echo=F}
library(clusterSim)
```

## Figures 2 and S.15 are generated here

```{r, echo=F}
source("compare_eigenvectors.r")
```

## Figures 3 and S.6 are generated here

```{r, echo=F}
source("uncertainty_quantification/uq_near_manifold.r")
```


## Run the Forest model for Figures 4 and 5
```{r, echo=F, warning=FALSE}
source("multiview_fmri_application/fMRI_analysis.r")
```


## Figures 4, 5 and S.13 are generated here
```{r, echo=F, warning=FALSE}
source("multiview_fmri_application/fMRI_analysis_results.r")
```
## Figure S.1, S.2 and Table S.1 are generated here

```{r, echo=F}
source("uncertainty_quantification/uq_high_dimesion_clustering.r")
```

## Figure S.3 is generated here

```{r, echo=F}
source("covariate_dependent_clustering/penguins.r")
```

## Figures S.4, S.5 and S.14 are generated here

```{r, echo=F}
source("uncertainty_quantification/uq_mixture_model_data_t_dist.r")
```


## Figure S.7, S.8, S.9 are generated here

```{r, echo=F}
do_run = F #To load the saved output and produce the figures or set T to re-run the simulations code before producing the figures
```

```{r, echo=F, warning=FALSE}
source("simulations/imbalanced_vs_clusteringErr.r")
```

```{r, warning=FALSE}
source("simulations/num_clusters_vs_clusteringErr.r")
```

```{r, warning=FALSE}
source("simulations/loosely_connected_graphs_vs_clusteringErr.r")
```

## Figures S.10, S.11, S.12 are generated here

```{r, echo=F}
source("simulations/mixing_diagnostics_multiple_initialization.r")
```

## Figure S.16 is generated here


```{r, echo=F}
source("simulations/sim_from_forest_apriori.r")
```